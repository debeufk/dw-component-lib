import { Meta } from "@storybook/addon-docs";

<Meta title="TaxonomyProviders/SharePoint" />

# SharePoint Taxonomy Provider

![taxonomyprovider-sharepoint package version](https://img.shields.io/github/package-json/v/dlw-digitalworkplace/dw-component-lib?filename=packages%2FtaxonomyProviders%2Fsharepoint%2Fpackage.json&label=%40dlw-digitalworkplace%2Ftaxonomyprovider-sharepoint&logo=github)

The `SharePointTaxonomyProvider` provides TermSet data using the `SP.Taxonomy.js` API. It can only be used when the
application is hosted on a SharePoint page.

> ðŸ’¡ You **MUST** call the `initialize()` method before using the provider's Taxonomy methods.

## Installation

```shell
yarn add @dlw-digitalworkplace/taxonomyprovider-sharepoint
```

## Usage

```tsx
import { SharePointTaxonomyProvider } from "@dlw-digitalworkplace/taxonomyprovider-sharepoint";

const provider = new SharePointTaxonomyProvider(siteUrl, termSetIdOrName, lcid /* optional */);
await provider.initialize(preCacheItems /* optional */);
```

## Documentation

The `SharePointTaxonomyProvider`'s methods are described here:

### `Constructor`

Creates a new `SharePointTaxonomyProvider` object.

| Parameter                                  | Type     | Description                                          | Default value |
| ------------------------------------------ | -------- | ---------------------------------------------------- | ------------- |
| siteUrl<span class="req">\*</span>         | `string` | URL of the current SharePoint site.                  |               |
| termSetIdOrName<span class="req">\*</span> | `string` | Name or ID (Guid) of the term set to connect to.     |               |
| lcid                                       | `number` | Language code to use when working with the Term Set. | `1033`        |

### `initialize(preCacheItems?): Promise<void>`

Initializes the provider, ensuring a connection to the referenced TermSet.

| Parameter     | Type      | Description                                                                                        |
| ------------- | --------- | -------------------------------------------------------------------------------------------------- |
| preCacheItems | `boolean` | If set, the TermSet's terms are cached immediately, which ensures faster responses when searching. |
